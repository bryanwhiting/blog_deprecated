

  
    
  


  




  


  

<!DOCTYPE html>
<html lang="en-us">
  <head>
    <script data-ad-client="ca-pub-6540088627087882" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Hugo 0.54.0">
    <meta name="theme" content="Tranquilpeak 0.3.1-BETA">
    <title>Dplyr vs Datatable</title>
    <meta name="author" content="Bryan Whiting">
    <meta name="keywords" content="">

    <link rel="icon" href="/favicon.png">
    

    
    <meta name="description" content="In the world of data science in R, the battle between dplyr and datatable is real. Here I compare their performance against base r commands for some common tasks. Who will be the winner on speed and simplicity?
Make random datasets set.seed(71) size1 &lt;- 4*10^6 size2 &lt;- size1 * 0.1 df1 &lt;- data.frame(id=paste0(&quot;SERVICE_&quot;, 1:size1), value=rnorm(size1), stringsAsFactors=FALSE) df2 &lt;- data.frame(id=paste0(&quot;SERVICE_&quot;, sample(1:size1, size2)), value=rnorm(size2), stringsAsFactors=FALSE) dt1 &lt;- data.table(df1) dt2 &lt;- data.table(df2) # mtcars data M &lt;- data.">
    <meta property="og:description" content="In the world of data science in R, the battle between dplyr and datatable is real. Here I compare their performance against base r commands for some common tasks. Who will be the winner on speed and simplicity?
Make random datasets set.seed(71) size1 &lt;- 4*10^6 size2 &lt;- size1 * 0.1 df1 &lt;- data.frame(id=paste0(&quot;SERVICE_&quot;, 1:size1), value=rnorm(size1), stringsAsFactors=FALSE) df2 &lt;- data.frame(id=paste0(&quot;SERVICE_&quot;, sample(1:size1, size2)), value=rnorm(size2), stringsAsFactors=FALSE) dt1 &lt;- data.table(df1) dt2 &lt;- data.table(df2) # mtcars data M &lt;- data.">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="Dplyr vs Datatable">
    <meta property="og:url" content="/2019/04/dplyr-vs-datatable/">
    <meta property="og:site_name" content="My take on data">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="My take on data">
    <meta name="twitter:description" content="In the world of data science in R, the battle between dplyr and datatable is real. Here I compare their performance against base r commands for some common tasks. Who will be the winner on speed and simplicity?
Make random datasets set.seed(71) size1 &lt;- 4*10^6 size2 &lt;- size1 * 0.1 df1 &lt;- data.frame(id=paste0(&quot;SERVICE_&quot;, 1:size1), value=rnorm(size1), stringsAsFactors=FALSE) df2 &lt;- data.frame(id=paste0(&quot;SERVICE_&quot;, sample(1:size1, size2)), value=rnorm(size2), stringsAsFactors=FALSE) dt1 &lt;- data.table(df1) dt2 &lt;- data.table(df2) # mtcars data M &lt;- data.">
    
      <meta name="twitter:creator" content="@bryanwhiting">
    
    

    
    

    
      <meta property="og:image" content="//www.gravatar.com/avatar/0082821b175de32596e4c5cbb525f846?s=640">
    

    
    
    

    

    
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.css" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/helpers/jquery.fancybox-thumbs.min.css" />
    
    
    <link rel="stylesheet" href="/css/style-u6mk0ojoywresbx8iepslrmmhl4stuhrsxuwhkpwrkrx7mryjcaimasnk4pi.min.css" />
    
    

    
      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-85616639-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

    
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="4">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="/">My take on data</a>
  </div>
  
    
      <a class="header-right-picture "
         href="/#about">
    
    
    
      
        <img class="header-picture" src="//www.gravatar.com/avatar/0082821b175de32596e4c5cbb525f846?s=90" alt="Author&#39;s picture" />
      
    
    </a>
  
</header>

      <nav id="sidebar" data-behavior="4">
  
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="/#about">
          <img class="sidebar-profile-picture" src="//www.gravatar.com/avatar/0082821b175de32596e4c5cbb525f846?s=110" alt="Author&#39;s picture" />
        </a>
        <h4 class="sidebar-profile-name">Bryan Whiting</h4>
        
          <h5 class="sidebar-profile-bio">father, innovator, data scientist</h5>
        
      </div>
    
    
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/">
    
      <i class="sidebar-button-icon fa fa-lg fa-home"></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/about/index.html">
    
      <i class="sidebar-button-icon fa fa-lg fa-question"></i>
      
      <span class="sidebar-button-desc">About</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/projects/index.html">
    
      <i class="sidebar-button-icon fa fa-lg fa-briefcase"></i>
      
      <span class="sidebar-button-desc">Projects</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/categories">
    
      <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
      
      <span class="sidebar-button-desc">Categories</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/tags">
    
      <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">Tags</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/archives">
    
      <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
      
      <span class="sidebar-button-desc">Archives</span>
    </a>
  </li>

    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://stackoverflow.com/users/2138773/bryan">
    
      <i class="sidebar-button-icon fa fa-lg fa-stack-overflow"></i>
      
      <span class="sidebar-button-desc">Stack Overflow</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://twitter.com/bryanwhiting">
    
      <i class="sidebar-button-icon fa fa-lg fa-twitter"></i>
      
      <span class="sidebar-button-desc">Twitter</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/bryanwhiting">
    
      <i class="sidebar-button-icon fa fa-lg fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.linkedin.com/in/bryan-whiting-b524a44b/">
    
      <i class="sidebar-button-icon fa fa-lg fa-linkedin"></i>
      
      <span class="sidebar-button-desc">LinkedIn</span>
    </a>
  </li>

    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/index.xml">
    
      <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
      
      <span class="sidebar-button-desc">RSS</span>
    </a>
  </li>

    </ul>
  </div>
  
</nav>

      

      <div id="main" data-behavior="4"
        class="
               hasCoverMetaIn
               ">
        <article class="post" itemscope itemType="http://schema.org/BlogPosting">
          
          
            <div class="post-header main-content-wrap text-left">
  
    <h1 class="post-title" itemprop="headline">
      Dplyr vs Datatable
    </h1>
  
  <div class="postShorten-meta post-meta">
  
    <time itemprop="datePublished" datetime="2019-04-04T00:00:00Z">
      
  April 4, 2019

    </time>
  
  
  
  
    <span>in</span>
    
      <a class="category-link" href="/categories/code">code</a>
    
  


</div>

</div>
          
          <div class="post-content markdown" itemprop="articleBody">
            <div class="main-content-wrap">
              


<p>In the world of data science in R, the battle between <code>dplyr</code> and <code>datatable</code> is real. Here I compare their performance against base r commands for some common tasks. Who will be the winner on speed and simplicity?</p>
<div id="make-random-datasets" class="section level1">
<h1>Make random datasets</h1>
<pre class="r"><code>set.seed(71)
size1 &lt;- 4*10^6
size2 &lt;- size1 * 0.1
df1 &lt;- data.frame(id=paste0(&quot;SERVICE_&quot;, 1:size1), value=rnorm(size1), stringsAsFactors=FALSE)
df2 &lt;- data.frame(id=paste0(&quot;SERVICE_&quot;, sample(1:size1, size2)), value=rnorm(size2), stringsAsFactors=FALSE)

dt1 &lt;- data.table(df1)
dt2 &lt;- data.table(df2)

# mtcars data
M &lt;- data.table(mtcars)
m &lt;- as_tibble(mtcars)</code></pre>
<p>Group by sum</p>
<pre class="r"><code>microbenchmark(
  times=100L,
  M[, sum(hp), by=cyl],
  mtcars %&gt;% group_by(cyl) %&gt;% summarise(sum(hp)),
  aggregate(x=mtcars$hp, by=list(cyl=mtcars$cyl), FUN=sum),
  aggregate(hp ~ cyl, data=mtcars, FUN=sum),
  tapply(X=mtcars$hp, INDEX=mtcars$cyl, FUN=sum),
  plyr::ddply(mtcars, &#39;cyl&#39;, plyr::summarise, sum(hp))
) </code></pre>
<pre><code>## Unit: microseconds
##                                                              expr      min
##                                            M[, sum(hp), by = cyl]  984.308
##                   mtcars %&gt;% group_by(cyl) %&gt;% summarise(sum(hp)) 1395.253
##  aggregate(x = mtcars$hp, by = list(cyl = mtcars$cyl), FUN = sum)  953.034
##                     aggregate(hp ~ cyl, data = mtcars, FUN = sum) 1210.410
##              tapply(X = mtcars$hp, INDEX = mtcars$cyl, FUN = sum)  207.599
##              plyr::ddply(mtcars, &quot;cyl&quot;, plyr::summarise, sum(hp)) 2580.687
##         lq      mean   median       uq       max neval
##  1451.6960 2065.5977 1655.470 1912.101 20003.058   100
##  1965.7315 2795.7730 2171.311 2528.985 17896.043   100
##  1141.5000 1342.8060 1252.845 1335.886  3748.162   100
##  1374.5885 1582.7563 1485.008 1619.644  3317.021   100
##   257.8225  297.2278  285.102  310.905  1260.213   100
##  2907.2670 3935.3080 3197.389 3669.062 30506.079   100</code></pre>
<p>Conclusion:</p>
<ul>
<li>tapply is wicked fast on this small dataset.</li>
<li>how does this scale as mtcars increase in size?</li>
</ul>
</div>
<div id="only-look-at-data.table-apply-and-dplyr." class="section level1">
<h1>Only look at data.table, apply, and dplyr.</h1>
<p><a href="https://www.r-bloggers.com/using-apply-sapply-lapply-in-r/" class="uri">https://www.r-bloggers.com/using-apply-sapply-lapply-in-r/</a></p>
<p>Double group by, sum of two column</p>
<pre class="r"><code>M[order(cyl, vs), lapply(.SD, sum, na.rm = T), by=.(cyl, vs), .SDcols=c(&#39;mpg&#39;, &#39;disp&#39;)]</code></pre>
<pre><code>##    cyl vs   mpg   disp
## 1:   4  0  26.0  120.3
## 2:   4  1 267.3 1036.2
## 3:   6  0  61.7  465.0
## 4:   6  1  76.5  818.2
## 5:   8  0 211.4 4943.4</code></pre>
<pre class="r"><code>M[order(cyl, vs), .(sum_mpg=sum(mpg), sum_disp=sum(disp)), by=.(cyl, vs)]</code></pre>
<pre><code>##    cyl vs sum_mpg sum_disp
## 1:   4  0    26.0    120.3
## 2:   4  1   267.3   1036.2
## 3:   6  0    61.7    465.0
## 4:   6  1    76.5    818.2
## 5:   8  0   211.4   4943.4</code></pre>
<pre class="r"><code>m %&gt;% group_by(cyl, vs) %&gt;% select(mpg, disp) %&gt;% summarise_all(.funs=sum)</code></pre>
<pre><code>## Adding missing grouping variables: `cyl`, `vs`</code></pre>
<pre><code>## # A tibble: 5 x 4
## # Groups:   cyl [?]
##     cyl    vs   mpg  disp
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     4     0  26    120.
## 2     4     1 267.  1036.
## 3     6     0  61.7  465 
## 4     6     1  76.5  818.
## 5     8     0 211.  4943.</code></pre>
<pre class="r"><code>m %&gt;% group_by(cyl, vs) %&gt;% summarise(sum(mpg), sum(disp))</code></pre>
<pre><code>## # A tibble: 5 x 4
## # Groups:   cyl [?]
##     cyl    vs `sum(mpg)` `sum(disp)`
##   &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;
## 1     4     0       26          120.
## 2     4     1      267.        1036.
## 3     6     0       61.7        465 
## 4     6     1       76.5        818.
## 5     8     0      211.        4943.</code></pre>
<pre class="r"><code>aggregate(cbind(mpg, disp) ~ cyl + vs, FUN=sum, data = mtcars)</code></pre>
<pre><code>##   cyl vs   mpg   disp
## 1   4  0  26.0  120.3
## 2   6  0  61.7  465.0
## 3   8  0 211.4 4943.4
## 4   4  1 267.3 1036.2
## 5   6  1  76.5  818.2</code></pre>
<pre class="r"><code>with(mtcars, aggregate(list(sum_mpg=mpg, sum_disp=disp), by = list(cyl=cyl, vs=vs), FUN=sum))</code></pre>
<pre><code>##   cyl vs sum_mpg sum_disp
## 1   4  0    26.0    120.3
## 2   6  0    61.7    465.0
## 3   8  0   211.4   4943.4
## 4   4  1   267.3   1036.2
## 5   6  1    76.5    818.2</code></pre>
<pre class="r"><code># two variables groups, tapply breaks down into three-by-two (not pretty)
with(mtcars, tapply(X=mpg, INDEX=list(cyl, vs), FUN=sum))</code></pre>
<pre><code>##       0     1
## 4  26.0 267.3
## 6  61.7  76.5
## 8 211.4    NA</code></pre>
<pre class="r"><code>with(mtcars, tapply(X=disp, INDEX=list(cyl, vs), FUN=sum))</code></pre>
<pre><code>##        0      1
## 4  120.3 1036.2
## 6  465.0  818.2
## 8 4943.4     NA</code></pre>
<pre class="r"><code># You could combine them using lapply/sapply. 
with(mtcars, lapply(list(disp=disp, mpg=mpg), function(x) tapply(X=x, INDEX=list(cyl=cyl, vs=vs), FUN=sum)))</code></pre>
<pre><code>## $disp
##    vs
## cyl      0      1
##   4  120.3 1036.2
##   6  465.0  818.2
##   8 4943.4     NA
## 
## $mpg
##    vs
## cyl     0     1
##   4  26.0 267.3
##   6  61.7  76.5
##   8 211.4    NA</code></pre>
<pre class="r"><code>with(mtcars, sapply(list(disp=disp, mpg=mpg), function(x) tapply(X=x, INDEX=list(cyl=cyl, vs=vs), FUN=sum)))</code></pre>
<pre><code>##        disp   mpg
## [1,]  120.3  26.0
## [2,]  465.0  61.7
## [3,] 4943.4 211.4
## [4,] 1036.2 267.3
## [5,]  818.2  76.5
## [6,]     NA    NA</code></pre>
<pre class="r"><code># Plyr
plyr::ddply(mtcars, plyr::.(cyl, vs), plyr::summarise, sum_mpg = sum(mpg), sum_disp=sum(disp))</code></pre>
<pre><code>##   cyl vs sum_mpg sum_disp
## 1   4  0    26.0    120.3
## 2   4  1   267.3   1036.2
## 3   6  0    61.7    465.0
## 4   6  1    76.5    818.2
## 5   8  0   211.4   4943.4</code></pre>
<pre class="r"><code>dt &lt;- function() M[order(cyl, vs), .(sum_mpg=sum(mpg), sum_disp=sum(disp)), by=c(&#39;cyl&#39;, &#39;vs&#39;)]
dp &lt;- function() m %&gt;% group_by(cyl, vs) %&gt;% summarise(sum(mpg), sum(disp))
ag &lt;- function() aggregate(cbind(mpg, disp) ~ cyl + vs, FUN=sum, data = mtcars)
la &lt;- function() with(mtcars, lapply(list(disp=disp, mpg=mpg), function(x) tapply(X=x, INDEX=list(cyl=cyl, vs=vs), FUN=sum)))
sa &lt;- function() with(mtcars, sapply(list(disp=disp, mpg=mpg), function(x) tapply(X=x, INDEX=list(cyl=cyl, vs=vs), FUN=sum)))
pl &lt;- function()  plyr::ddply(mtcars, plyr::.(cyl, vs), plyr::summarise, sum_mpg = sum(mpg), sum_disp=sum(disp))

# Compare speeds of top approaches
microbenchmark(
  times=100L,
  dt(),
  dp(),
  ag(),
  la(),
  sa(),
  pl()
)</code></pre>
<pre><code>## Unit: microseconds
##  expr      min        lq      mean   median       uq       max neval
##  dt() 1840.965 2365.6115 3625.6795 2955.488 3683.574 29689.690   100
##  dp() 2194.468 2361.0175 3018.3744 2573.593 3057.261 24208.547   100
##  ag() 1882.167 2076.0035 2538.4617 2264.648 2643.394 13054.272   100
##  la()  578.740  696.0965  843.8617  744.078  834.230  6411.912   100
##  sa()  603.055  720.3955  911.7546  778.282  873.011  6693.510   100
##  pl() 3527.191 3918.8410 4696.1208 4272.321 4886.168 24423.534   100</code></pre>
<p>Conclusion:</p>
<ul>
<li>Tapply breaks down when you start introducing additional groups. Not easy to read.</li>
<li>For tapply, it seems you ahve to do two statements, or you could use lapply (which returns a list), or you could use sapply and feed lapply.</li>
<li>sapply removes the labels, so you’d have to keep track of the indexing yourself.</li>
<li>plyr seems like Hadley’s early work of love (2011). But he re-worked the package into <code>dplyr</code>, which is now 100x easier to use.</li>
</ul>
</div>
<div id="filter-and-summarize" class="section level1">
<h1>Filter and summarize</h1>
<p>Get the mean of one and sum of the other by group</p>
<pre class="r"><code>M[cyl &gt; 4, .(summ=sum(mpg), sumd=sum(disp)), by=.(cyl, vs)]</code></pre>
<pre><code>##    cyl vs  summ   sumd
## 1:   6  0  61.7  465.0
## 2:   6  1  76.5  818.2
## 3:   8  0 211.4 4943.4</code></pre>
<pre class="r"><code>mtcars %&gt;% filter(cyl &gt; 4) %&gt;% group_by(cyl, vs) %&gt;% summarise(sum(mpg), sum(disp))</code></pre>
<pre><code>## # A tibble: 3 x 4
## # Groups:   cyl [?]
##     cyl    vs `sum(mpg)` `sum(disp)`
##   &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;
## 1     6     0       61.7        465 
## 2     6     1       76.5        818.
## 3     8     0      211.        4943.</code></pre>
<pre class="r"><code>aggregate(cbind(mpg, disp) ~ cyl + vs, FUN=sum, data = mtcars, subset=(cyl &gt; 4))</code></pre>
<pre><code>##   cyl vs   mpg   disp
## 1   6  0  61.7  465.0
## 2   8  0 211.4 4943.4
## 3   6  1  76.5  818.2</code></pre>
<pre class="r"><code>with(mtcars[which(mtcars$cyl &gt; 4),], lapply(list(mpg, disp), function(x) tapply(x, INDEX=list(cyl, vs), sum)))</code></pre>
<pre><code>## [[1]]
##       0    1
## 6  61.7 76.5
## 8 211.4   NA
## 
## [[2]]
##        0     1
## 6  465.0 818.2
## 8 4943.4    NA</code></pre>
</div>
<div id="compare-dplyr-vs-datatable-to-do-strings-of-tasks" class="section level1">
<h1>Compare dplyr vs datatable to do strings of tasks:</h1>
<ol style="list-style-type: decimal">
<li>filter/subset</li>
<li>mutate</li>
<li>join (merge)</li>
<li>group by</li>
<li>summarize</li>
<li>order</li>
<li>reshape</li>
</ol>
</div>

              
            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small">TAGGED IN</span><br/>
                    
  <a class="tag tag--primary tag--small" href="//tags/r/">r</a>

  <a class="tag tag--primary tag--small" href="//tags/dplyr/">dplyr</a>

  <a class="tag tag--primary tag--small" href="//tags/datatable/">datatable</a>

                  </div>
                
              
            
            <div class="post-actions-wrap">
  <nav>
    <ul class="post-actions post-action-nav">
      
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="/2019/09/baby-boy-names/" data-tooltip="Scraping Baby Boy Name Trends">
          
            <i class="fa fa-angle-left"></i>
            <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
          </a>
        </li>
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="/2019/02/rshiny-on-docker-part2/" data-tooltip="Getting Custom Domain for EC2 Web App - Part 2">
          
            <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
            <i class="fa fa-angle-right"></i>
          </a>
        </li>
      
    </ul>
  </nav>
  <ul class="post-actions post-action-share">
    
      <li class="post-action hide-lg hide-md hide-sm">
        <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
          <i class="fa fa-share-alt"></i>
        </a>
      </li>
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=%2f2019%2f04%2fdplyr-vs-datatable%2f">
          <i class="fa fa-google-plus"></i>
        </a>
      </li>
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=%2f2019%2f04%2fdplyr-vs-datatable%2f">
          <i class="fa fa-facebook-official"></i>
        </a>
      </li>
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=%2f2019%2f04%2fdplyr-vs-datatable%2f">
          <i class="fa fa-twitter"></i>
        </a>
      </li>
    
    
      <li class="post-action">
        <a class="post-action-btn btn btn--default" href="#disqus_thread">
          <i class="fa fa-comment-o"></i>
        </a>
      </li>
    
    <li class="post-action">
      
        <a class="post-action-btn btn btn--default" href="#">
      
        <i class="fa fa-list"></i>
      </a>
    </li>
  </ul>
</div>


            
              
                <div id="disqus_thread">
  <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
              
            
          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
   
   
  <script>
  $(document).ready(function () {
    window.initializeCodeFolding("show" === "hide");
  });
  </script>
  <script src="/js/codefolding.js"></script>


    
  <span class="copyrights">
    &copy; 2019 Bryan Whiting. All Rights Reserved
  </span>
</footer>

      </div>
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
        <div class="post-actions-wrap">
  <nav>
    <ul class="post-actions post-action-nav">
      
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="/2019/09/baby-boy-names/" data-tooltip="Scraping Baby Boy Name Trends">
          
            <i class="fa fa-angle-left"></i>
            <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
          </a>
        </li>
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="/2019/02/rshiny-on-docker-part2/" data-tooltip="Getting Custom Domain for EC2 Web App - Part 2">
          
            <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
            <i class="fa fa-angle-right"></i>
          </a>
        </li>
      
    </ul>
  </nav>
  <ul class="post-actions post-action-share">
    
      <li class="post-action hide-lg hide-md hide-sm">
        <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
          <i class="fa fa-share-alt"></i>
        </a>
      </li>
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=%2f2019%2f04%2fdplyr-vs-datatable%2f">
          <i class="fa fa-google-plus"></i>
        </a>
      </li>
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=%2f2019%2f04%2fdplyr-vs-datatable%2f">
          <i class="fa fa-facebook-official"></i>
        </a>
      </li>
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=%2f2019%2f04%2fdplyr-vs-datatable%2f">
          <i class="fa fa-twitter"></i>
        </a>
      </li>
    
    
      <li class="post-action">
        <a class="post-action-btn btn btn--default" href="#disqus_thread">
          <i class="fa fa-comment-o"></i>
        </a>
      </li>
    
    <li class="post-action">
      
        <a class="post-action-btn btn btn--default" href="#">
      
        <i class="fa fa-list"></i>
      </a>
    </li>
  </ul>
</div>


      </div>
      <div id="share-options-bar" class="share-options-bar" data-behavior="4">
  <ul class="share-options">
    <li class="share-option">
      <a class="share-option-btn" target="new" href="https://plus.google.com/share?url=%2f2019%2f04%2fdplyr-vs-datatable%2f">
        <i class="fa fa-google-plus"></i><span>Share on Google Plus</span>
      </a>
    </li>
    <li class="share-option">
      <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=%2f2019%2f04%2fdplyr-vs-datatable%2f">
        <i class="fa fa-facebook-official"></i><span>Share on Facebook</span>
      </a>
    </li>
    <li class="share-option">
      <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=%2f2019%2f04%2fdplyr-vs-datatable%2f">
        <i class="fa fa-twitter"></i><span>Share on Twitter</span>
      </a>
    </li>
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>
    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-remove"></i>
    </div>
    
      <img id="about-card-picture" src="//www.gravatar.com/avatar/0082821b175de32596e4c5cbb525f846?s=110" alt="Author&#39;s picture" />
    
    <h4 id="about-card-name">Bryan Whiting</h4>
    
      <div id="about-card-bio">father, innovator, data scientist</div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        Data Scientist
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker"></i>
        <br/>
        Washington, D.C.
      </div>
    
  </div>
</div>

    <div id="algolia-search-modal" class="modal-container">
  <div class="modal">
    <div class="modal-header">
      <span class="close-button"><i class="fa fa-close"></i></span>
      <a href="https://algolia.com" target="_blank" class="searchby-algolia text-color-light link-unstyled">
        <span class="searchby-algolia-text text-color-light text-small">by</span>
        <img class="searchby-algolia-logo" src="https://www.algolia.com/static_assets/images/press/downloads/algolia-light.svg">
      </a>
      <i class="search-icon fa fa-search"></i>
      <form id="algolia-search-form">
        <input type="text" id="algolia-search-input" name="search"
          class="form-control input--large search-input" placeholder="Search" />
      </form>
    </div>
    <div class="modal-body">
      <div class="no-result text-color-light text-center">no post found</div>
      <div class="results">
        
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/2019/10/sample-size/">
                <h3 class="media-heading">Sample Size</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Oct 10, 2019
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">So your boss likes asking questions. Let’s find answers to a few she might ask.
# Go and collect some car data df = read.table(&#39;ftp://ftp.ics.uci.edu/pub/machine-learning-databases/auto-mpg/auto-mpg.data-original&#39;, col.names = c(&#39;mpg&#39;, &#39;cyl&#39;, &#39;disp&#39;, &#39;hp&#39;, &#39;wt&#39;, &#39;acc&#39;, &#39;year&#39;, &#39;origin&#39;, &#39;name&#39;)) # Let&#39;s randomly shuffle the rows set.seed(1) df &lt;- df[sample(nrow(df)),] # Extract make df$make &lt;- word(df$name) df %&lt;&gt;% filter(!is.na(mpg)) %&gt;% select(name, make, everything()) One Sample T-Test  Question 1: I think Ford cars have pretty bad miles-per-gallon (MPG).</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/2019/10/births-time-series-month/">
                <h3 class="media-heading">Modeling Birth Rates Part 2: By Month</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Oct 10, 2019
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">In Part 1, I modeled births at the year level, which didn’t seem to have much seasonality. Now I’m going to try to model the monthly birth rates in the US.
Predicting Seasonality I hit up the UN data to get seasonal birthrates, which I couldn’t find at CDC. Unfortunately, the UN data doesn’t have a long range of data.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/2019/10/births-time-series-year/">
                <h3 class="media-heading">Modeling Birth Rates Part 1: By Year</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Oct 10, 2019
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">I’m still excited to be a dad, so I’m going to try to model birth rates in the US. This will be a time series modeling exercise, and I’ll use this time to explore some modeling techniques. In Part 2 I’ll model the monthly birth rates.
I downloaded CDC birth data from here: * https://www.cdc.gov/nchs/data-visualization/natality-trends/ * “Births and General Fertility Rates” &gt; Download CSV * Other data sets can be found here: https://www.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/2019/10/baby-names/">
                <h3 class="media-heading">Why does everyone I work with have the same name? A guide on how to not pick a unique baby name in America.</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Oct 10, 2019
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">I’ve taken a particular interest in names since I’m thinking of a name for my to-be-born son. I did a little digging through the Social Security Administration names database, which lists all names given to baby boys and girls in America1. I began this exercise to just get a quality list of ideas, but my curiosity got the better of me.
Name Trends Since 1950 What was the most popular boy name since 1950?</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/2019/09/baby-boy-names/">
                <h3 class="media-heading">Scraping Baby Boy Name Trends</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Sep 9, 2019
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">I’m going to be a dad (again) soon. I don’t want my boy to have a common name, so I gotta do my research. I’m curious: how do names trend over time? If I pick a name today, will it be popular tomorrow?
Step 1: The Social Security Administration reports all baby names each year in the United States, given the name occurs at least 5 times.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/2019/04/dplyr-vs-datatable/">
                <h3 class="media-heading">Dplyr vs Datatable</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Apr 4, 2019
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">In the world of data science in R, the battle between dplyr and datatable is real. Here I compare their performance against base r commands for some common tasks. Who will be the winner on speed and simplicity?
Make random datasets set.seed(71) size1 &lt;- 4*10^6 size2 &lt;- size1 * 0.1 df1 &lt;- data.frame(id=paste0(&quot;SERVICE_&quot;, 1:size1), value=rnorm(size1), stringsAsFactors=FALSE) df2 &lt;- data.frame(id=paste0(&quot;SERVICE_&quot;, sample(1:size1, size2)), value=rnorm(size2), stringsAsFactors=FALSE) dt1 &lt;- data.table(df1) dt2 &lt;- data.table(df2) # mtcars data M &lt;- data.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/2019/02/rshiny-on-docker-part2/">
                <h3 class="media-heading">Getting Custom Domain for EC2 Web App - Part 2</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Feb 2, 2019
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">In this post, I&rsquo;ll cover how to better customize some settings so to get your own custom domain for your EC2 instance. Say, app.example.com. Anyone interested in customizing an EC2 instance can use this - not just those who build R Shiny apps. I assume you already read part 1, where it was described how to launch an R Shiny app on EC2. I assume you already have some EC2 instance running with some useful app.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/2019/02/rshiny-on-docker-part1/">
                <h3 class="media-heading">R Shiny on AWS Using Docker - Part 1</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Feb 2, 2019
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">I want to run R Shiny on AWS using Docker. Here&rsquo;s how to do it.
In part 2, I&rsquo;ll demonstrate how to get a custom domain and make the URL look clean.
Useful background reading If you&rsquo;re already comfortable with Docker, skip to the next section.
 Great Simple tutorial on using Docker and Flask: Short and sweet. Docker for Beginners: Verbose and lengthy. Excellent introduction. Walks you through all the jargon.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/2018/09/machine-learning-models/">
                <h3 class="media-heading">Machine Learning Model Notes</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Sep 9, 2018
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">Here are some notes on machine learning models.
Concepts Behind Decision Trees  Bagging (boostrap aggregation): Randomly sample with replacement, and average the results. Majority vote: The most commonly-occuring prediction. Internal node: Where the splits occur. Branches: Segments that connect the nodes. Terminal node (leafs, regions): Where the observations end up. The average of the responses (or majority vote) is the prediction for future observations. Gini index: where \(m\) is the leaf and \(k\) is the class (0 or 1 for binary classification, but can be extedned for multiple classes).</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/2018/09/byu-football/">
                <h3 class="media-heading">byu football</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Sep 9, 2018
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">Goal of this post. Answer some interesting questions about BYU football. Dive into different modeling approaches. I don’t explain my thinking below, but some of the charts might be cool.
Some questions of interest
 How is Kilani Sitake doing in his second season compared to past BYU coaches? More challenging: how’s he doing relative to all second-season coaches?  df_in &lt;- read.csv(file.path(fp_data, &#39;byu_seasons.csv&#39;)) %&gt;% distinct() Some basic questions: * How many years do we have data on?</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
      </div>
    </div>
    <div class="modal-footer">
      <p class="results-count text-medium"
         data-message-zero="no post found"
         data-message-one="1 post found"
         data-message-other="{n} posts found">
         25 posts found
      </p>
    </div>
  </div>
</div>
    
  
    
    <div id="cover" style="background-image:url('/images/durango-blurred.JPG');"></div>
  


    
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/helpers/jquery.fancybox-thumbs.min.js"></script>


<script src="/js/script-wl33z0n6ocaypepiqrazthtivfrliqijej4rq8ek8gvrv1awftmgjuv8k4zc.min.js"></script>

<script>
$(document).ready(function() {
  hljs.configure({ classPrefix: '', useBR: false });
  $('pre.code-highlight').each(function(i, block) {
    var code = "";
    hljs.highlightAuto(block.innerText).value.split(/\r\n|\r|\n/).forEach(function(line) {
      code += "<span class=\"line\">" + line + "</span><br>";
    });
    if (code.length > 0) {
      block.innerHTML = code;  
    }
  });
  $('pre > code').each(function(i, block) {
    $(this).addClass('codeblock');
    hljs.highlightBlock(block);
  });
});
</script>

  
    
      <script>
        var disqus_config = function () {
          this.page.url = '\/2019\/04\/dplyr-vs-datatable\/';
          
            this.page.identifier = '\/2019\/04\/dplyr-vs-datatable\/'
          
        };
        (function() {
          
          
          if (window.location.hostname == "localhost") {
            return;
          }
          var d = document, s = d.createElement('script');
          var disqus_shortname = 'bryanwhiting1';
          s.src = '//' + disqus_shortname + '.disqus.com/embed.js';

          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
        })();
      </script>
    
  





    
  </body>
</html>

